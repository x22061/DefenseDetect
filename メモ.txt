研究概要
・どんなものか
　ハンドボールの試合映像を用いて，どこが攻められているのかを画像処理で判断する．
　防御フォーメーションを自動で推定する．

・目的
　失点につながっている部分がどこなのかを判断する
　逆に得点につながっている部分はどこかも判断できる．相手の弱点を判断できる．
　試合中にフォーメーションがどう切り替わっているかのデータを取得し，戦略の手助けを行う

・手法
　フォーメーションの自動分類
　　選手の位置をYOLOで推定，バウンディングボックス内の色を抽出し，チーム判別．
　　射影変換を行い，上面図の座標に正規化．上面図上で選手の配置からフォーメーションを推定
　　
　攻撃されている箇所の判別手法はシューターを追跡すること
　選手の移動量を検出.移動量が多い部分が攻められている場所と判定
　ゴール前は3分割？
　センターかサイドか

　・やってみたこと
　　ハンガリアン法でテンプレのフォーメーションと一番近い選手の配置で推定
　　・ゴール側の6人で限定してみると．．．
　　　精度は良くない
　　　なんで？
　　　　端っこの方に誤推定の人
　　　　下の監督を誤推定
　　　　あまり検出する人に制限はかけたくない．．．
　　・全選手からどれかのフォーメーションと一番近くなる配置を見つけて推定．．．
　　　精度は良くない
　　　なんで？
　　　　ハンドボールの防御フォーメーションはぐちゃぐちゃになる．だから他のフォーメーションの形に近しい配置になることがしばしばあるから
　　・9mラインを境として，外側にいる選手の数で判別
　　・推定に使うフレームを防御フェーズ単位で限定する
　　　防御フェーズとは，開始フレームはdirectionが切り替わった後で最初に防御選手を6人以上推定したフレームで，
　　　終了フレームは9mラインの外側にいる選手が内側に戻る瞬間か，directionが切り替わる瞬間
　　　directionの切り替わりでやる場合は，一つの防御フェーズが50フレーム以内にならないようにする
　　　精度はかなり良い

　・9mラインを基準に判断していく
　　　それぞれのフォーメーションの一番の違いは9mラインを境として，それぞれの領域に何人の選手がいるのか
　　　　この方法の課題は9mラインよりも前にいる選手が動き回ることで検出できないこと
　　　　9mラインの内側に戻っちゃうと他のフォーメーションに近い形になること
　　　それを解決するには？
　　　　9mラインの外側から内側に戻った人数を判断する．

　・防御フェーズの開始地点をなんとか求めたい
　　　攻撃が始まる前は綺麗な配置になっているので，できれば攻撃開始前から攻撃開始後までの範囲(フレーム)を求めてその中で推定を行いたい．おそらく一番精度が高くなる
　　　
　　　じゃあどうやって求める？
　　　　ゴールの方向の変わり目を開始地点とする．
　　　　　ただし，リプレイシーンもあってここはそこまで正確じゃないから，6人の選手を検出してなおかつゴールが変わった最初のフレームとする．
　　　　　これでも精度が良くなければ選手の位置が整っている瞬間で考える
　　　　　例えば，分散や選手間の距離感とか？難しそうだけど．．．
　　　　攻撃が始まったかどうかは？
　　　　　9mラインから内側に選手が戻ったタイミング
　　　　　もしいなければ0-6ってことだろうし，いたらその瞬間までで推定できそう
　　　　　結構いいかも
　　　　　どうやって選手が戻ったか判定しよう？
　　　　　　選手のIDは取れている
　　　　　　9mラインの外側にいる防御選手のIDを求めて同じIDの人の座標が9mラインよりも内側になったタイミング
　　　　　　推定できていないフレームも結構あるから上手くいかない可能性があることを理解してやっていきたい

・これからやること
　　・防御選手のいる位置を思い切って限定しちゃう
　　　汎用性がなくなるからあまりやりたくないけど，絶対いなそうな場所はあるはず
